<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>客户端储存: 对比localStorage和indexDB(2020.3.13) | 黄梓阳的博客</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="阳阳的博客">
    
    <link rel="preload" href="/assets/css/0.styles.f3e2e2a4.css" as="style"><link rel="preload" href="/assets/js/app.54f8f1fa.js" as="script"><link rel="preload" href="/assets/js/2.2f22998c.js" as="script"><link rel="preload" href="/assets/js/1.0b444f9c.js" as="script"><link rel="preload" href="/assets/js/29.9e65e1f0.js" as="script"><link rel="prefetch" href="/assets/js/10.857b132a.js"><link rel="prefetch" href="/assets/js/11.70ce96a9.js"><link rel="prefetch" href="/assets/js/12.aeb15f03.js"><link rel="prefetch" href="/assets/js/13.9afedd12.js"><link rel="prefetch" href="/assets/js/14.a7ca9f66.js"><link rel="prefetch" href="/assets/js/15.f4a73f35.js"><link rel="prefetch" href="/assets/js/16.5992fb4c.js"><link rel="prefetch" href="/assets/js/17.4ae81fed.js"><link rel="prefetch" href="/assets/js/18.1198418d.js"><link rel="prefetch" href="/assets/js/19.522653f4.js"><link rel="prefetch" href="/assets/js/20.9a129639.js"><link rel="prefetch" href="/assets/js/21.319a0f2c.js"><link rel="prefetch" href="/assets/js/22.6fbeeff6.js"><link rel="prefetch" href="/assets/js/23.06aef352.js"><link rel="prefetch" href="/assets/js/24.ee7cd5df.js"><link rel="prefetch" href="/assets/js/25.cb651ac7.js"><link rel="prefetch" href="/assets/js/26.8f918548.js"><link rel="prefetch" href="/assets/js/27.b030d040.js"><link rel="prefetch" href="/assets/js/28.8131c166.js"><link rel="prefetch" href="/assets/js/3.953f4699.js"><link rel="prefetch" href="/assets/js/30.3908f4ee.js"><link rel="prefetch" href="/assets/js/31.e4606d04.js"><link rel="prefetch" href="/assets/js/32.937a6f11.js"><link rel="prefetch" href="/assets/js/33.543a5aa9.js"><link rel="prefetch" href="/assets/js/34.68e811e0.js"><link rel="prefetch" href="/assets/js/35.34bad009.js"><link rel="prefetch" href="/assets/js/36.dcc348b0.js"><link rel="prefetch" href="/assets/js/37.f19ecafd.js"><link rel="prefetch" href="/assets/js/38.15194dcb.js"><link rel="prefetch" href="/assets/js/39.f7c64b24.js"><link rel="prefetch" href="/assets/js/4.fb7d3d5a.js"><link rel="prefetch" href="/assets/js/40.dec6d238.js"><link rel="prefetch" href="/assets/js/41.56f518a6.js"><link rel="prefetch" href="/assets/js/42.e33010d7.js"><link rel="prefetch" href="/assets/js/5.2731d5ee.js"><link rel="prefetch" href="/assets/js/6.1a2ed5d7.js"><link rel="prefetch" href="/assets/js/7.6e421a42.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.232f1e4d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f3e2e2a4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">黄梓阳的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/" class="sidebar-heading clickable router-link-active open"><span>文档</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/supportRN/" class="sidebar-link">React Native 能支持 Typescript 到什么地步?</a></li><li><a href="/js-type/" class="sidebar-link">怎么判断 JavaScript 的各种类型--回字的六种写法</a></li><li><a href="/generator/" class="sidebar-link">Generator 生成器与协程</a></li><li><a href="/passive/" class="sidebar-link">passive 事件处理器</a></li><li><a href="/capture-problem/" class="sidebar-link">截屏插件显示异常踩坑修复解决流水</a></li><li><a href="/indexDB/" aria-current="page" class="active sidebar-link">对比localStorage和indexDB</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/indexDB/#背景" class="sidebar-link">背景</a></li><li class="sidebar-sub-header"><a href="/indexDB/#是什么" class="sidebar-link">是什么</a></li><li class="sidebar-sub-header"><a href="/indexDB/#为什么" class="sidebar-link">为什么</a></li><li class="sidebar-sub-header"><a href="/indexDB/#怎么用" class="sidebar-link">怎么用</a></li><li class="sidebar-sub-header"><a href="/indexDB/#兼容性" class="sidebar-link">兼容性</a></li><li class="sidebar-sub-header"><a href="/indexDB/#总结" class="sidebar-link">总结</a></li><li class="sidebar-sub-header"><a href="/indexDB/#demo" class="sidebar-link">DEMO</a></li></ul></li><li><a href="/smokeTest/" class="sidebar-link">'冒烟测试'到底冒的是啥</a></li><li><a href="/CSSGrid/" class="sidebar-link">CSS Grid</a></li><li><a href="/BFC/" class="sidebar-link">BFC</a></li><li><a href="/performance/" class="sidebar-link">性能优化的方案</a></li><li><a href="/gitMirrorClone/" class="sidebar-link">git 镜像克隆仓库</a></li><li><a href="/gitContribute/" class="sidebar-link">git提交未计算贡献(未显示小绿点)的解决办法</a></li><li><a href="/interview/" class="sidebar-link">面试题</a></li><li><a href="/myZoom/" class="sidebar-link">hzyhhh</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="客户端储存-对比localstorage和indexdb-2020-3-13"><a href="#客户端储存-对比localstorage和indexdb-2020-3-13" class="header-anchor">#</a> 客户端储存: 对比localStorage和indexDB(2020.3.13)</h1> <h2 id="背景"><a href="#背景" class="header-anchor">#</a> 背景</h2> <p>IndexedDB 是一种在用户浏览器中持久存储数据的方法。<em>它允许您不考虑网络可用性</em>，创建具有丰富查询能力的<strong>可离线 Web 应用程序</strong>。IndexedDB 对于<strong>存储大量数据的应用程序</strong>和不需要持久 Internet 连接的应用程序很有用。</p> <hr> <h2 id="是什么"><a href="#是什么" class="header-anchor">#</a> 是什么</h2> <blockquote><p>IndexedDB 是一种使用浏览器存储大量数据的方法.它创造的数据可以被查询，并且可以离线使用. IndexedDB 对于那些需要存储大量数据，或者是需要离线使用的程序是非常有效的解决方法. --- MDN</p></blockquote> <blockquote><p>使用 IndexedDB，你可以存储或者获取数据，使用一个 key 索引的。 你可以在事务(transaction)中完成对数据的修改。和大多数 web 存储解决方案相同，indexedDB 也遵从同源协议(same-origin policy). 所以你只能访问同域中存储的数据，而不能访问其他域的。</p> <p>IndexedDB 是一种异步(asynchronous) API，异步 API 适用于大多数情况，包括 Web Workers。因为在 Web Workers 上的使用，它过去也有一个同步(synchronous)的版本，但是因为缺少 web 社区的支持，它已经被从规范中移除了。</p> <p>IndexedDB 过去有一个竞争规范—— WebSQL 数据库，但是 W3C 组织在 2010 年 11 月 18 日废弃了 webSql。尽管两者都是存储的解决方案，但是他们提供的不是同样的功能。IndexedDB 和 WebSQL 的不同点在于 WebSQL 是关系型数据库访问系统，IndexedDB 是索引表系统(key-value 型)。</p></blockquote> <h2 id="为什么"><a href="#为什么" class="header-anchor">#</a> 为什么</h2> <p>Cookie 作为前端存储有这许多缺点,所以经过前端社区的不断努力,在 HTML5 中有了真正的前端存储方案--Web Storage.它分为两种,一种是永久存储的 localStorage,一种是会话期间存储的 sessionStorage.对比 Cookie,Web Storage 的优势很明显:</p> <blockquote><ul><li>存储空间更大,有 5M 大小</li> <li>在浏览器发送请求是不会带上 web Storage 里的数据</li> <li>更加友好的 API</li> <li>可以做永久存储(localStorage).</li></ul></blockquote> <p>这一切看起来很完美,但是随着前端的不断发展,web Storage 也有了一些不太合适的地方:</p> <blockquote><ol><li>随着 web 应用程序的不断发展,5M 的存储大小对于一些大型的 web 应用程序来说有些不够</li> <li>web Storage 只能存储 string 类型的数据.对于 Object 类型的数据只能先用 JSON.stringify()转换一下在存储.</li></ol></blockquote> <p>基于上述原因,前端社区又提出了浏览器数据库存储这个概念.而 Web SQL Database 和 indexedDB(索引数据库)是对这个概念的实现.其中 Web SQL Database 在目前来说基本已经被放弃.所以目前主流的浏览器数据库的实现就是 indexedDB(索引数据库).</p> <h2 id="怎么用"><a href="#怎么用" class="header-anchor">#</a> 怎么用</h2> <p><a href="'https://developer.mozilla.org/zh-CN/docs/Web/API/IndexedDB_API'">api 介绍 ⬅</a></p> <h3 id="打开"><a href="#打开" class="header-anchor">#</a> 打开</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> request <span class="token operator">=</span> window<span class="token punctuation">.</span>indexedDB<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;MyTestDatabase&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>兼容性写法</p> <div class="language-js extra-class"><pre class="language-js"><code>window<span class="token punctuation">.</span>indexDB <span class="token operator">=</span>
  window<span class="token punctuation">.</span>indexedDB <span class="token operator">||</span>
  window<span class="token punctuation">.</span>mozIndexedDB <span class="token operator">||</span>
  window<span class="token punctuation">.</span>webkitIndexedDB <span class="token operator">||</span>
  window<span class="token punctuation">.</span>msIndexedDB<span class="token punctuation">;</span>

<span class="token keyword">var</span> request <span class="token operator">=</span> window<span class="token punctuation">.</span>indexDB<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;MyTestDatabase&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>该 open 方法接受第二个参数，就是数据库的版本号。数据库的版本决定了数据库架构，即数据库的对象仓库（object store）和他的结构。如果数据库不存在，open 操作会创建该数据库，然后 onupgradeneeded 事件被触发，你需要在该事件的处理函数中创建数据库模式。如果数据库已经存在，但你指定了一个更高的数据库版本，会直接触发 onupgradeneeded 事件，允许你在处理函数中更新数据库模式。我们在后面的更新数据库的版本号和 IDBFactory.open 中会提到更多有关这方面的内容。</p></blockquote> <h3 id="初始"><a href="#初始" class="header-anchor">#</a> 初始</h3> <blockquote><p>onupgradeneeded 是唯一可以更改数据库结构的地方。在其中，您可以创建和删除对象存储以及构建和删除索引。</p></blockquote> <p>初始的动作需要在 request.onupgradeneeded 内完成,该操作只会执行一次,类似与数据库的建表操作</p> <p>该方法执行时会暴露 Event,该对象内 Event.target.result 属于 IDBDatabase 对象</p> <p>IDBDatabase 对象可以由 onupgradeneeded 执行时暴露的 Event 获取 同时也可以 IDBOpenDBRequest.result 返回</p> <p>Event.target.result 和 IDBOpenDBRequest.result 返回值都是 IDBDatabase 对象</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">onupgradeneeded</span><span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// evt.target.result是一个IDBDatabase对象, 该对象可操作indexdb数据库, 常用的操作是用该对象创建字段</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>db <span class="token operator">=</span> evt<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> db <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>db<span class="token punctuation">.</span>objectStoreNames<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> objectStore <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">createObjectStore</span><span class="token punctuation">(</span><span class="token string">&quot;info&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">keyPath</span><span class="token operator">:</span> <span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">autoIncrement</span><span class="token operator">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      objectStore<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">unique</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      objectStore<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      objectStore<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token string">&quot;province&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;province&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      objectStore<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token string">&quot;address&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;address&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      objectStore<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token string">&quot;birthDate&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;birthDate&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      objectStore<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token string">&quot;remark&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;remark&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;---onupgradeneeded---&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre></div><h3 id="curd"><a href="#curd" class="header-anchor">#</a> CURD</h3> <blockquote><p>在使用新数据库执行任何操作之前，需要启动事务。事务来自数据库对象，您必须指定要跨事务的对象存储。一旦进入事务，就可以访问保存数据的对象存储并发出请求。接下来，您需要确定是要对数据库进行更改还是只需要读取数据库。交易有三种可用模式：readonly，readwrite，和 versionchange。</p></blockquote> <p>CURD 操作需要 IDBObjectStore 对象</p> <p>该对象由 IDBDatabase 对象下的 transaction(事务).objectStore 函数返回</p> <p>由于数据库的操作都是基于事务（transaction）来进行，于是，无论是添加编辑还是删除数据库，我们都要先建立一个事务（transaction），然后才能继续下面的操作。语法就是名称：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> transaction <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">transaction</span><span class="token punctuation">(</span>dbName<span class="token punctuation">,</span> <span class="token string">&quot;readwrite&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>有该对象就能愉快的进行 CURD</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 对数据库进行操作时 需要先获取到IDBDatabase对象</span>
  <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>db <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>DBOpenRequest<span class="token punctuation">.</span>result<span class="token punctuation">;</span>

    <span class="token keyword">const</span> request <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>transaction<span class="token punctuation">.</span><span class="token function">objectStore</span><span class="token punctuation">(</span><span class="token string">&quot;info&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      request<span class="token punctuation">.</span>onsuccess <span class="token operator">=</span> resolve<span class="token punctuation">;</span>
      request<span class="token punctuation">.</span>onerror <span class="token operator">=</span> reject<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">delete</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>db <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>DBOpenRequest<span class="token punctuation">.</span>result<span class="token punctuation">;</span>

    <span class="token keyword">const</span> request <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>transaction<span class="token punctuation">.</span><span class="token function">objectStore</span><span class="token punctuation">(</span><span class="token string">&quot;info&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      request<span class="token punctuation">.</span>onsuccess <span class="token operator">=</span> resolve<span class="token punctuation">;</span>
      request<span class="token punctuation">.</span>onerror <span class="token operator">=</span> reject<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">readAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 游标Cursor可以对数据对象进行批量操作</span>
    <span class="token keyword">const</span> request <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>transaction<span class="token punctuation">.</span><span class="token function">objectStore</span><span class="token punctuation">(</span><span class="token string">&quot;info&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">openCursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      request<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span> <span class="token operator">=</span> <span class="token parameter">evt</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> cursor <span class="token operator">=</span> evt<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>cursor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
          cursor<span class="token punctuation">.</span><span class="token function">continue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token function">resolve</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>

      request<span class="token punctuation">.</span>onerror <span class="token operator">=</span> reject<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre></div><h2 id="兼容性"><a href="#兼容性" class="header-anchor">#</a> 兼容性</h2> <p><img src="/assets/img/caniuse.591295f3.jpg" alt="caniuse"></p> <h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <h3 id="indexeddb-存储和-localstorage-存储对比"><a href="#indexeddb-存储和-localstorage-存储对比" class="header-anchor">#</a> indexedDB 存储和 localStorage 存储对比</h3> <ul><li>indexedDB 存储 IE10+支持，localStorage 存储 IE8+支持，后者兼容性更好</li> <li>indexedDB 存储比较适合键值对较多的数据.在使用 localStorage 存储时，每次写入和写出都要字符串化和对象化，很麻烦，但如果使用 indexedDB 会轻松很多，因为无需数据转换。</li> <li>indexedDB 存储可以在 workers 中使用，localStorage 貌似不可以。这就使得在进行 PWA 开发的时候，数据存储的技术选型落在了 indexedDB 存储上面。</li></ul> <blockquote><p>总结下就是，如果是浏览器主窗体线程开发，同时存储数据结构简单，例如，就存个 true/false，显然 localStorage 上上选；如果数据结构比较复杂，同时对浏览器兼容性没什么要求，可以考虑使用 indexedDB；如果是在 Service Workers 中开发应用，只能使用 indexedDB 数据存储。</p></blockquote> <h2 id="demo"><a href="#demo" class="header-anchor">#</a> <a href="https://github.com/Hzyhhh/indexDB" target="_blank" rel="noopener noreferrer"><strong>DEMO</strong><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h2> <p>更多请参见:</p> <p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/IndexedDB_API" target="_blank" rel="noopener noreferrer">👍 IndexedDB<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://hacks.mozilla.org/2012/02/storing-images-and-files-in-indexeddb/" target="_blank" rel="noopener noreferrer">Storing images and files in IndexedDB<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://www.tangshuang.net/3735.html" target="_blank" rel="noopener noreferrer">👍 IndexedDB 中文教程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://www.zhangxinxu.com/wordpress/2017/07/html5-indexeddb-js-example/" target="_blank" rel="noopener noreferrer">👍 HTML5 indexedDB 前端本地存储数据库实例教程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/capture-problem/" class="prev">
        截屏插件显示异常踩坑修复解决流水
      </a></span> <span class="next"><a href="/smokeTest/">
        '冒烟测试'到底冒的是啥
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.54f8f1fa.js" defer></script><script src="/assets/js/2.2f22998c.js" defer></script><script src="/assets/js/1.0b444f9c.js" defer></script><script src="/assets/js/29.9e65e1f0.js" defer></script>
  </body>
</html>
