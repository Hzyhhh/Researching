(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{336:function(t,e,a){t.exports=a.p+"assets/img/folder.2fb022c8.png"},337:function(t,e,a){t.exports=a.p+"assets/img/support.1f28ef8c.png"},366:function(t,e,a){"use strict";a.r(e);var r=a(27),v=Object(r.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h2",{attrs:{id:"react-native-能支持-typescript-到什么地步"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#react-native-能支持-typescript-到什么地步"}},[t._v("#")]),t._v(" React Native 能支持 Typescript 到什么地步?")]),t._v(" "),e("h2",{attrs:{id:"疑问的产生"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#疑问的产生"}},[t._v("#")]),t._v(" 疑问的产生")]),t._v(" "),e("p",[t._v("新团队在业务上使用 app + web 的模式, 具体的开发框架也就自然而然地选择了 "),e("code",[t._v("React Native")]),t._v(" + "),e("code",[t._v("Vue")]),t._v(", 所以在选人方面就没有这么多技术限制; 基本上来人就能做业务.")]),t._v(" "),e("p",[t._v("开发语言选型了 js. 极大提高了业务的灵活性. 虽然是使用弱类型语言, 但 "),e("code",[t._v("RN")]),t._v(" 在由模板创建的一刻起就支持 "),e("code",[t._v("typescript")]),t._v(", 这也是这篇文章诞生的前提:")]),t._v(" "),e("p",[t._v("在写"),e("code",[t._v("RN")]),t._v("的过程中发现一个很有意思的现象, 在原有 js 架构上引入 ts 甚至 tsx 后在原有的架构上都不会有报错或者是不兼容的提示.")]),t._v(" "),e("p",[t._v("我一度认为这个兼容是该项目创作者特地为之. 随着开发的深入和对架构的理解后我发现. "),e("strong",[t._v("并不是")]),t._v(".")]),t._v(" "),e("h2",{attrs:{id:"实践的过程"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#实践的过程"}},[t._v("#")]),t._v(" 实践的过程")]),t._v(" "),e("p",[t._v("我使用 RN 模板创建了一个 RN-App, RN 并没有像 Web 的 React、Vue 一样用 webpack 这类构建工具, 反倒使用的是 facebook 自研的编译工具 "),e("a",{attrs:{href:"https://facebook.github.io/metro/docs/getting-started",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("Metro")]),e("OutboundLink")],1),t._v(", 在转译方面使用比较广泛的 babel. 所以整个 RN 应用看起来还是比较简洁的.")]),t._v(" "),e("p",[e("img",{attrs:{src:a(336),alt:"folder"}})]),t._v(" "),e("p",[t._v("在 babel 的配置文件中,也只有的一个预设配置 metro-react-native-babel-preset 因此我的测试路线就变成了这样:")]),t._v(" "),e("ul",[e("li",[t._v("解释问题缘由")]),t._v(" "),e("li",[t._v("已知 React 特性包括 jsx、ESNext 等可能会影响编译的问题")]),t._v(" "),e("li",[t._v("在排除 babel 插件支持 react 特性的情况下考虑以下几个问题：")]),t._v(" "),e("li",[e("ul",[e("li",[t._v("纯 js 编写 RN 是否编译异常 （大概率会）")])])]),t._v(" "),e("li",[e("ul",[e("li",[t._v("若不会，能否支持 flow 或者 typescript (大概率不能)")])])]),t._v(" "),e("li",[e("ul",[e("li",[t._v("能否得出总结：RN 在没有任何特性支持的情况下不能编译。现有官方推荐 babel 插件能支持 jsx/tsx、EXNext(✔ 真理)")])])])]),t._v(" "),e("h2",{attrs:{id:"真相"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#真相"}},[t._v("#")]),t._v(" 真相")]),t._v(" "),e("p",[e("img",{attrs:{src:a(337),alt:"123"}})]),t._v(" "),e("p",[t._v("在翻阅 "),e("code",[t._v("metro-react-native-babel-preset")]),t._v(" 源码的过程中, 代码前几行赫然把该篇文章的答案写了出来, 预设已经将所有 ts、tsx 文件用 "),e("code",[t._v("@babel/plugin-transform-typescript")]),t._v(" 帮你转好了.")]),t._v(" "),e("h2",{attrs:{id:"rn-runtime-运行时"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rn-runtime-运行时"}},[t._v("#")]),t._v(" RN runtime 运行时")]),t._v(" "),e("p",[t._v("初始化 React Native")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("babel 转义 ESNext、ts、tsx 成 JavaScript")])]),t._v(" "),e("li",[e("p",[t._v("读取 JavaScript 源码")])]),t._v(" "),e("li",[e("p",[t._v("JavaScript 加载进内存, JSX 代码已经被转化成原生的 JavaScript 代码")])]),t._v(" "),e("li",[e("p",[t._v("初始化模块信息")])]),t._v(" "),e("li",[e("p",[t._v("这一步在方法 initModulesWithDispatchGroup 中实现，主要任务是找到所有需要暴露给 JavaScript 的类")])]),t._v(" "),e("li",[e("p",[t._v("初始化 JavaScript 代码的执行器，即 RCTJSCExecutor 对象")])]),t._v(" "),e("li",[e("p",[t._v("生成模块列表并写入 JavaScript 端")])]),t._v(" "),e("li",[e("p",[t._v("执行 JavaScript 源码")])])]),t._v(" "),e("h2",{attrs:{id:"参考"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[t._v("#")]),t._v(" 参考")]),t._v(" "),e("ul",[e("li",[e("p",[e("a",{attrs:{href:"https://github1s.com/facebook/metro/blob/master/packages/metro-react-native-babel-preset/src/configs/main.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("metro-react-native-babel-preset 源码"),e("OutboundLink")],1)])]),t._v(" "),e("li",[e("p",[e("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/66243553",target:"_blank",rel:"noopener noreferrer"}},[t._v("知乎 - RN 集成 TypeScript 方案和问题大全"),e("OutboundLink")],1)])]),t._v(" "),e("li",[e("p",[e("a",{attrs:{href:"https://segmentfault.com/a/1190000005775584",target:"_blank",rel:"noopener noreferrer"}},[t._v("React-Native 运行机制"),e("OutboundLink")],1)])])])])}),[],!1,null,null,null);e.default=v.exports}}]);